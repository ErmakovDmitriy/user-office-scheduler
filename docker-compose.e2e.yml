version: "3.1"

services:
  scheduler-frontend:
    build:
      context: "./${USER_OFFICE_SCHEDULER_FRONTEND_DIR}"
      args:
        - PUBLIC_URL=/scheduler
    labels:
      - "traefik.frontend.rule=PathPrefix:/scheduler; PathPrefixStrip:/scheduler"
      - "traefik.port=80"
    depends_on:
      - gateway

  cypress:
    build:
      context: "./${USER_OFFICE_SCHEDULER_FRONTEND_DIR}/cypress"
    ipc: host
    entrypoint:
      [
        "./wait-for-frontend.sh",
        "scheduler-frontend:80/scheduler",
        "npm run cy:run",
      ]
    depends_on:
      - scheduler-frontend
